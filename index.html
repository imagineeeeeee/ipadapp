<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Store Management Dashboard</title>
    <!-- Tailwind CSS for modern and responsive styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Custom styles for the app */
        body {
            font-family: 'Inter', sans-serif;
        }
        .container {
            max-width: 90%;
            margin: auto;
        }
    </style>
</head>
<body class="bg-gray-50 text-gray-800 antialiased">

    <!-- Main container for the entire application -->
    <div class="min-h-screen flex items-center justify-center p-4">

        <!-- Login Form Section -->
        <div id="login-container" class="bg-white rounded-3xl shadow-lg p-8 w-full max-w-sm transition-all duration-300">
            <h1 class="text-3xl font-bold text-center mb-6">Store Login</h1>
            <p id="login-error" class="text-red-500 text-center mb-4 hidden">Invalid username or password.</p>
            <form id="login-form" class="space-y-4">
                <div>
                    <label for="username" class="block text-sm font-medium text-gray-700">Username</label>
                    <input type="text" id="username" name="username" class="mt-1 block w-full rounded-xl border-gray-300 shadow-sm p-3 focus:ring-blue-500 focus:border-blue-500" required>
                </div>
                <div>
                    <label for="password" class="block text-sm font-medium text-gray-700">Password</label>
                    <input type="password" id="password" name="password" class="mt-1 block w-full rounded-xl border-gray-300 shadow-sm p-3 focus:ring-blue-500 focus:border-blue-500" required>
                </div>
                <button type="submit" class="w-full bg-blue-600 text-white font-semibold py-3 px-4 rounded-xl hover:bg-blue-700 transition-colors duration-200 shadow-md">
                    Login
                </button>
            </form>
        </div>

        <!-- Product Dashboard Section (Hidden by default) -->
        <div id="dashboard-container" class="hidden w-full max-w-4xl p-8 bg-white rounded-3xl shadow-lg transition-all duration-300">
            <div class="flex justify-between items-center mb-6">
                <h1 class="text-3xl font-bold">Product Dashboard</h1>
                <button id="logout-btn" class="bg-red-500 text-white font-semibold py-2 px-4 rounded-xl hover:bg-red-600 transition-colors duration-200 shadow-md">
                    Logout
                </button>
            </div>

            <!-- Product Search and Add form -->
            <div class="mb-8 p-6 bg-gray-50 rounded-2xl shadow-inner">
                <form id="product-form" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                    <input type="hidden" id="product-id">
                    <div class="col-span-1">
                        <label for="product-name" class="block text-sm font-medium text-gray-700">Product Name</label>
                        <input type="text" id="product-name" class="mt-1 block w-full rounded-xl border-gray-300 p-2" required>
                    </div>
                    <div class="col-span-1">
                        <label for="product-price" class="block text-sm font-medium text-gray-700">Price</label>
                        <input type="number" id="product-price" class="mt-1 block w-full rounded-xl border-gray-300 p-2" step="0.01" required>
                    </div>
                    <div class="col-span-1">
                        <label for="product-stock" class="block text-sm font-medium text-gray-700">Stock</label>
                        <input type="number" id="product-stock" class="mt-1 block w-full rounded-xl border-gray-300 p-2" required>
                    </div>
                    <div class="col-span-1">
                        <label for="product-discount" class="block text-sm font-medium text-gray-700">Discount (%)</label>
                        <input type="number" id="product-discount" class="mt-1 block w-full rounded-xl border-gray-300 p-2" min="0" max="100" value="0">
                    </div>
                    <div class="col-span-1 flex items-end">
                        <button type="submit" id="submit-btn" class="w-full bg-green-500 text-white font-semibold py-2 px-4 rounded-xl hover:bg-green-600 transition-colors duration-200">
                            Add Product
                        </button>
                    </div>
                    <div class="col-span-1 flex items-end">
                        <button type="button" id="search-btn" class="w-full bg-indigo-500 text-white font-semibold py-2 px-4 rounded-xl hover:bg-indigo-600 transition-colors duration-200">
                            Search by ID
                        </button>
                    </div>
                </form>
            </div>

            <!-- Products List -->
            <div class="overflow-x-auto">
                <table class="min-w-full divide-y divide-gray-200 rounded-xl overflow-hidden">
                    <thead class="bg-gray-100">
                        <tr>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">ID</th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Name</th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Price</th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Stock</th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Discount</th>
                            <th class="px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider">Actions</th>
                        </tr>
                    </thead>
                    <tbody id="products-table-body" class="bg-white divide-y divide-gray-200">
                        <!-- Product rows will be dynamically inserted here by JavaScript -->
                    </tbody>
                </table>
            </div>
            
            <!-- Message box for user notifications -->
            <div id="message-box" class="fixed bottom-4 left-1/2 -translate-x-1/2 p-4 bg-gray-900 text-white rounded-xl shadow-lg transition-opacity duration-300 opacity-0 pointer-events-none z-50">
                <p id="message-text"></p>
            </div>
        </div>
    </div>

    <script>
        // Store all DOM elements for easy access
        const loginContainer = document.getElementById('login-container');
        const loginForm = document.getElementById('login-form');
        const loginError = document.getElementById('login-error');
        const dashboardContainer = document.getElementById('dashboard-container');
        const logoutBtn = document.getElementById('logout-btn');
        const productForm = document.getElementById('product-form');
        const submitBtn = document.getElementById('submit-btn');
        const searchBtn = document.getElementById('search-btn');
        const productsTableBody = document.getElementById('products-table-body');
        const productIdInput = document.getElementById('product-id');
        const productNameInput = document.getElementById('product-name');
        const productPriceInput = document.getElementById('product-price');
        const productStockInput = document.getElementById('product-stock');
        const productDiscountInput = document.getElementById('product-discount');
        const messageBox = document.getElementById('message-box');
        const messageText = document.getElementById('message-text');

        // Function to show a temporary message box
        const showMessage = (text, type = 'info') => {
            messageText.textContent = text;
            messageBox.style.opacity = '1';
            messageBox.style.backgroundColor = type === 'error' ? '#EF4444' : '#1F2937';
            setTimeout(() => {
                messageBox.style.opacity = '0';
            }, 3000);
        };

        // Check if the user is already logged in on page load
        document.addEventListener('DOMContentLoaded', () => {
            const isLoggedIn = localStorage.getItem('isLoggedIn');
            if (isLoggedIn === 'true') {
                showDashboard();
            } else {
                showLogin();
            }
        });

        // Event listener for the login form submission
        loginForm.addEventListener('submit', (e) => {
            e.preventDefault();
            const username = e.target.username.value;
            const password = e.target.password.value;

            if (username === 'admin' && password === '1234') {
                localStorage.setItem('isLoggedIn', 'true');
                showDashboard();
            } else {
                loginError.textContent = 'Invalid username or password.';
                loginError.classList.remove('hidden');
                setTimeout(() => loginError.classList.add('hidden'), 3000);
            }
        });

        // Event listener for the logout button
        logoutBtn.addEventListener('click', () => {
            localStorage.removeItem('isLoggedIn');
            showLogin();
            showMessage('You have been logged out.');
        });

        // Event listener for the product form submission (Add/Edit)
        productForm.addEventListener('submit', (e) => {
            e.preventDefault();

            const products = JSON.parse(localStorage.getItem('products')) || [];
            const newProduct = {
                id: productIdInput.value ? productIdInput.value : generateUniqueId(products),
                name: productNameInput.value,
                price: parseFloat(productPriceInput.value),
                stock: parseInt(productStockInput.value),
                discount: parseInt(productDiscountInput.value) || 0
            };

            if (productIdInput.value) {
                // Edit existing product
                const index = products.findIndex(p => p.id === newProduct.id);
                if (index !== -1) {
                    products[index] = newProduct;
                    showMessage(`Product "${newProduct.name}" updated successfully!`);
                }
                submitBtn.textContent = 'Add Product'; // Reset button text
            } else {
                // Add new product
                products.push(newProduct);
                showMessage(`Product "${newProduct.name}" added successfully!`);
            }

            localStorage.setItem('products', JSON.stringify(products));
            renderProducts(products);
            productForm.reset();
        });

        // Event listener for the search button
        searchBtn.addEventListener('click', () => {
            const products = JSON.parse(localStorage.getItem('products')) || [];
            const searchTerm = prompt("Enter a Product ID to search for:");
            if (searchTerm) {
                const foundProduct = products.find(p => p.id === searchTerm);
                if (foundProduct) {
                    renderProducts([foundProduct]);
                    showMessage(`Found product with ID: ${searchTerm}`);
                } else {
                    renderProducts([]); // Clear the table
                    showMessage(`No product found with ID: ${searchTerm}`, 'error');
                }
            } else {
                // If search is canceled, show all products again
                renderProducts(products);
            }
        });

        // Functions to show/hide sections
        function showLogin() {
            loginContainer.classList.remove('hidden');
            dashboardContainer.classList.add('hidden');
        }

        function showDashboard() {
            loginContainer.classList.add('hidden');
            dashboardContainer.classList.remove('hidden');
            renderProducts(JSON.parse(localStorage.getItem('products')) || []);
        }

        // Function to generate a unique ID
        function generateUniqueId(products) {
            let lastId = parseInt(localStorage.getItem('lastProductId')) || 0;
            lastId++;
            localStorage.setItem('lastProductId', lastId);
            return 'PROD' + lastId.toString().padStart(4, '0');
        }

        // Function to render products into the table
        function renderProducts(products) {
            productsTableBody.innerHTML = '';
            if (products.length === 0) {
                const row = document.createElement('tr');
                row.innerHTML = `<td colspan="6" class="p-4 text-center text-gray-500 italic">No products found.</td>`;
                productsTableBody.appendChild(row);
                return;
            }

            products.forEach(product => {
                const row = document.createElement('tr');
                row.classList.add('hover:bg-gray-50');
                row.innerHTML = `
                    <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">${product.id}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">${product.name}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">$${product.price.toFixed(2)}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">${product.stock}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">${product.discount}%</td>
                    <td class="px-6 py-4 whitespace-nowrap text-center text-sm font-medium">
                        <button onclick="editProduct('${product.id}')" class="text-blue-600 hover:text-blue-900 mx-1">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 inline-block" viewBox="0 0 20 20" fill="currentColor">
                                <path d="M13.586 3.586a2 2 0 112.828 2.828l-.793.793-2.828-2.828.793-.793zM11.379 5.793L3 14.172V17h2.828l8.38-8.379-2.83-2.828z" />
                            </svg>
                        </button>
                        <button onclick="deleteProduct('${product.id}')" class="text-red-600 hover:text-red-900 mx-1">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 inline-block" viewBox="0 0 20 20" fill="currentColor">
                                <path fill-rule="evenodd" d="M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm4 0a1 1 0 10-2 0v6a1 1 0 102 0V8z" clip-rule="evenodd" />
                            </svg>
                        </button>
                    </td>
                `;
                productsTableBody.appendChild(row);
            });
        }

        // Global functions for buttons in the table
        window.editProduct = function(id) {
            const products = JSON.parse(localStorage.getItem('products')) || [];
            const product = products.find(p => p.id === id);
            if (product) {
                productIdInput.value = product.id;
                productNameInput.value = product.name;
                productPriceInput.value = product.price;
                productStockInput.value = product.stock;
                productDiscountInput.value = product.discount;
                submitBtn.textContent = 'Update Product';
                showMessage(`Editing product: ${product.name}`);
            }
        }

        window.deleteProduct = function(id) {
            const products = JSON.parse(localStorage.getItem('products')) || [];
            const updatedProducts = products.filter(p => p.id !== id);
            localStorage.setItem('products', JSON.stringify(updatedProducts));
            renderProducts(updatedProducts);
            showMessage(`Product with ID ${id} deleted successfully.`, 'error');
        }
    </script>
</body>
</html>
